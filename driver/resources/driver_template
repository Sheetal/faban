import java.util.StringTokenizer;
import java.net.URLEncoder;

import com.sun.faban.driver.*;
import com.sun.faban.driver.util.ContentSizeStats;
import com.sun.faban.driver.util.Random;

@BenchmarkDefinition@

@BenchmarkDriver (
 name  = "@BenchmarkDriverName@",
 threadPerScale = 1 
)

@RequestLagTime@

public class @DriverClassName@ {

private HttpTransport httpTransport;
private DriverContext ctx;
private Random random;
private ContentSizeStats contentStats = null;

public @DriverClassName@(){
	 httpTransport = new HttpTransport();
	 ctx = DriverContext.getContext();
     random = ctx.getRandom();
     contentStats = new ContentSizeStats(ctx.getOperationCount());
     ctx.attachMetrics(contentStats);
}

private static String doEncode(String s) {
    StringTokenizer tok = new StringTokenizer(s, "&");
    StringBuilder results = new StringBuilder();
    boolean isFirst = true;
    while (tok.hasMoreTokens()) {
	StringTokenizer param = new StringTokenizer(tok.nextToken(), "=");
	String name = param.nextToken();
	String value = param.nextToken();
	if (!isFirst) {
	    results.append("&");
	}
	else isFirst = false;
	results.append(URLEncoder.encode(name));
	results.append("=");
	results.append(URLEncoder.encode(value));
    }
    return results.toString();
}

#operation
@Statics@
@Operations@
@RequestLagTime@
public void @operationName@() throws Exception{

	try{
            String url = @url@;
            int bytesRead = httpTransport.readURL(url@postRequest@);
            //System.out.println("url:"+url);

            if (ctx.isTxSteadyState())
                contentStats.sumContentSize[ctx.getOperationId()] += bytesRead;
	}catch(Exception ex){
	  ex.printStackTrace();
          throw ex;
	}

}
operation#
}
